<!DOCTYPE html>
<html>

  <head>
    <title>Atlas Reality</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400" rel="stylesheet">
    <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://www.atlasreality.xyz/style.css" />

    <!-- defines the firebase library -->
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script>
        var config = {
            apiKey: "AIzaSyBI9kkVq2jZNpTKjaX79BqgcepavI9wzQs",
            authDomain: "mosaic-portal.firebaseapp.com",
            projectId: "mosaic-portal",
            storageBucket: "mosaic-portal.appspot.com",
        };
        // cF2SedCeMFWTmEP4evpFcogOONH3 <-- cianna@mariecanning.com uid
        firebase.initializeApp(config);

        window.onload = function initApp() {

          console.log("here");

            // Listening for auth state changes.
          // [START authstatelistener]
          firebase.auth().onAuthStateChanged(function(user) {
            // [START_EXCLUDE silent]
            // [END_EXCLUDE]
            if (user) {
              // User is signed in.
              var displayName = user.displayName;
              var email = user.email;
              var emailVerified = user.emailVerified;
              var photoURL = user.photoURL;
              var isAnonymous = user.isAnonymous;
              var uid = user.uid;
              var providerData = user.providerData;

              console.log(displayName + ' '  + email);

              if (!emailVerified) {
              }
              // [END_EXCLUDE]
            } else {
              console.log("why are we here");
              // User is signed out.
              // [START_EXCLUDE]
              // [END_EXCLUDE]
            }
            // [START_EXCLUDE silent]
            // [END_EXCLUDE]
          });
          // [END authstatelistener]
        }
    </script>
  </head>
  <body>

    <div class="dashnavbar">
      <ul>
        <li><a href="https://www.atlasreality.xyz" class="generalnav">Atlas</a></li>
        <li><a class="generalnav">SDK</a></li>
        <li><a class="dashnavelement">{{username}}</a></li>
        <li><a href="https://www.atlasreality.xyz/auth/logout" class="dashnavelement">Logout</a></li>
      </ul>
    </div>

    <div class="wrapper">
      <div class="grid-item">
        <div>
            <label for="file-upload" class="custom-file-upload">
                <img src="https://www.atlasreality.xyz/addButton.png" alt="Add new scene" height="162" width="162">
                <input id="file-upload" type="file" name="scene" value="Please upload your scene">
                <script>
                  // https://eloquentjavascript.net/18_forms.html
                  var fileUploadButton = document.querySelector('input');
                  fileUploadButton.addEventListener("change", function() {
                    // if (input.files.length > 0) {
                    //   var file = input.files[0];
                    //   console.log("You chose", file.name);
                    //   if (file.type)
                    //     console.log("It has type", file.type);
                    // }

                    // const firebase = require('firebase');

                    var storage = firebase.storage();

                    if (fileUploadButton.files.length > 0) {
                      var file = fileUploadButton.files[0];
                      var storageRef = storage.ref().child('users/cF2SedCeMFWTmEP4evpFcogOONH3/scene1.png');

                      // var metadata = {
                      //   contentType: 'image/jpeg'
                      // };

                      // uploadfile and then re-render this page with the new user data
                      var uploadTask = storageRef.put(file).then(function(){
                        $.get("https://www.google.com")
                      });

                      // // Listen for state changes, errors, and completion of the upload.
                      // uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
                      //    function() {
                      //   // Upload completed successfully, now we can get the download URL
                      //   var downloadURL = uploadTask.snapshot.downloadURL;
                      // });
                    }
                  });
                </script>
            </label>
        </div>
        <p>Add New Scene</p>
      </div>

      <!-- Add all the scenes in a loop below -->

      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
      <!-- <div class="grid-item"><img src="" alt="" height="162" width="91"><p>Scene</p></div> -->
    </div>

  </body>
</html>
